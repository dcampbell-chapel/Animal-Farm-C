<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Animal Farm Character Analysis Hub</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar styling for better aesthetics */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #FFCCCC; } /* Light Red Track */
        ::-webkit-scrollbar-thumb { background: #CC0000; border-radius: 4px; } /* Accent Red Thumb */
        ::-webkit-scrollbar-thumb:hover { background: #B30000; } /* Primary Red Hover */

        /* Ensure smooth transitions for responsiveness */
        * { transition: all 0.2s ease-in-out; }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Custom Red Monochromatic Theme based on the original class C file
                        'page-bg': '#FFCCCC',   // Light Red/Pink page background
                        'primary-red': '#B30000', // Deep Red (Main Brand Color)
                        'accent-red': '#CC0000',  // Slightly deeper Red (Accents, Borders)
                        'sidebar-bg': '#800000', // Very dark maroon for high contrast sidebar
                        'paper': '#fefefe',      // Off-white paper background for cards
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>
<!-- Apply the new light red background -->
<body class="bg-page-bg font-sans min-h-screen flex flex-col md:flex-row">

    <!-- Mobile Menu Button (Hamburger) -->
    <!-- Button now uses the Primary Red color -->
    <button id="menu-btn" class="md:hidden fixed top-4 left-4 z-40 p-2 bg-primary-red text-white rounded-full shadow-lg">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
    </button>

    <!-- Sidebar / Navigation Menu -->
    <!-- Sidebar now uses a dark maroon background for high contrast -->
    <nav id="sidebar" class="fixed inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition-transform duration-300 ease-in-out w-64 bg-sidebar-bg text-white z-30 shadow-2xl flex flex-col pt-16 md:pt-0">
        
        <!-- Sidebar Header uses a slightly lighter dark red -->
        <header class="p-6 border-b border-[#a00000] bg-[#a00000]">
            <!-- Title is white for high visibility -->
            <h1 class="text-2xl font-bold text-white">Animal Farm</h1>
            <p class="text-xs text-red-200 mt-1">Character & Context Synthesis</p>
        </header>

        <ul class="flex-1 p-4 space-y-2 overflow-y-auto">
            <!-- Navigation links and hover states updated to use the red palette -->
            <li class="nav-item">
                <a href="#home" data-page="home" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üè† Overview</a>
            </li>
            <li class="nav-item">
                <a href="#napoleon" data-page="napoleon" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üêΩ Napoleon</a>
            </li>
            <li class="nav-item">
                <a href="#snowball" data-page="snowball" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">‚ö™ Snowball</a>
            </li>
            <li class="nav-item">
                <a href="#squealer" data-page="squealer" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üê∑ Squealer</a>
            </li>
            <li class="nav-item">
                <a href="#boxer" data-page="boxer" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üê¥ Boxer (Example)</a>
            </li>
            <!-- Updated Benjamin to Benjamin & Clover -->
            <li class="nav-item">
                <a href="#benjamin-clover" data-page="benjamin-clover" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üêê Benjamin & Clover</a>
            </li>
            <li class="nav-item">
                <a href="#humans" data-page="humans" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üë§ The Humans</a>
            </li>
            <li class="nav-item">
                <a href="#mollie-moses" data-page="mollie-moses" class="block py-3 px-4 rounded-lg text-lg font-medium text-red-100 hover:bg-primary-red hover:text-white transition duration-150 ease-in-out">üéÄ Mollie & Moses</a>
            </li>
        </ul>

        <footer class="p-4 text-xs text-red-400 border-t border-[#a00000]">
            Project Structure v2.1
        </footer>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-1 p-4 md:p-8 overflow-y-auto min-h-screen">
        <div id="content-view" class="max-w-4xl mx-auto">
            <!-- Content will be injected here by JavaScript -->
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const contentView = document.getElementById('content-view');
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.getElementById('menu-btn');
            
            // --- 1. Define Page Content ---
            const PAGES = {
                'home': `
                    <!-- Home page content -->
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">F/G Period Character Portfolio</h2>
                        <p class="text-gray-700">Click around to see your classmates' work and to review the context and significance of each character in the novel.</p>
                        <p class="mt-6 text-sm text-gray-500 italic">Select a character from the menu on the left to load their analysis report.</p>
                    </div>
                `,
                'napoleon': `
                    <!-- NEW: Napoleon Page Placeholder -->
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">üêΩ Napoleon: The Tyrant</h2>
                        <p class="text-gray-700">Paste the HTML content for your <strong>Napoleon</strong> report here. This analysis focuses on his ruthless rise to power and consolidation of control. Remember to remove the <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags from your original file before pasting it into this string.</p>
                    </div>
                `,
                'snowball': `
                    <!-- NEW: Snowball Page Placeholder -->
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">‚ö™ Snowball: Idealism and Exile</h2>
                        <p class="text-gray-700">Paste the HTML content for your <strong>Snowball</strong> report here. This section covers his role as a brilliant but ultimately defeated revolutionary. Remove external tags.</p>
                    </div>
                `,
                'squealer': `
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">üê∑ Squealer: Master of Propaganda</h2>
                        <p class="text-gray-700">Paste the HTML content for your <strong>Squealer</strong> report here. Remember to remove the <code>&lt;html&gt;</code>, <code>&lt;head&gt;</code>, and <code>&lt;body&gt;</code> tags from your original Squealer file before pasting it into this string.</p>
                    </div>
                `,
                'boxer': `
                    <!-- Boxer Sketchnotes Content (boxer_sketchnotes.html) adapted to use Tailwind styling -->
                    <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-accent-red max-w-4xl mx-auto">
                        <header class="text-center p-6 bg-yellow-100 rounded-t-lg border-b-4 border-yellow-500 mb-6">
                            <h1 class="text-3xl font-extrabold text-primary-red mb-1">üê¥ Boxer: The Tragic Proletariat</h1>
                            <p class="text-lg text-gray-600">Character and Context Synthesis Report</p>
                        </header>
                        
                        <div class="grid md:grid-cols-2 gap-8">
                            
                            <section class="p-4 bg-red-50 border-l-4 border-primary-red rounded-lg shadow-md">
                                <h2 class="text-xl font-bold text-accent-red mb-2">‚≠ê Core Identity</h2>
                                <p class="text-gray-700"><strong>Two Maxims:</strong> "I will work harder" and "Napoleon is always right."</p>
                                <p class="text-gray-700 mt-2">The strongest animal on the farm, known for his incredible work ethic, simple-minded loyalty, and unquestioning trust in leadership.</p>
                                <details class="mt-4 p-2 bg-red-100 rounded-md">
                                    <summary class="font-semibold cursor-pointer text-primary-red">üîé Character Analysis</summary>
                                    <p class="text-sm pt-2">His strength is his downfall; it makes him valuable to the Pigs until he is no longer useful. Boxer's loyalty reveals how a dictator's power can be sustained by the genuine devotion of the exploited.</p>
                                </details>
                            </section>

                            <section class="p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded-lg shadow-md">
                                <h2 class="text-xl font-bold text-accent-red mb-2">ü™ì Historical Parallel</h2>
                                <p class="text-gray-700">Boxer allegorically represents the <strong>Proletariat and Peasantry</strong> of Soviet Russia.</p>
                                <details class="mt-4 p-2 bg-yellow-100 rounded-md">
                                    <summary class="font-semibold cursor-pointer text-primary-red">üîó Explore the Allegory</summary>
                                    <p class="text-sm pt-2">His relentless work on the windmill mirrors the Soviet people‚Äôs sacrifices under Stalin‚Äôs Five-Year Plans. His final betrayal and sale to the knacker is Orwell's harshest indictment of the Soviet state's cruelty toward its most loyal subjects.</p>
                                </details>
                            </section>
                            
                            <section class="md:col-span-2 p-4 bg-green-50 border-l-4 border-green-500 rounded-lg shadow-md">
                                <h2 class="text-xl font-bold text-accent-red mb-2">üí≠ Big Picture & Thematic Warning</h2>
                                <p class="text-gray-700">Boxer‚Äôs story blends **hope, tragedy, and warning**‚Äîa reminder that revolutions can devour their own heroes.</p>
                                <ul class="list-disc list-inside mt-2 text-gray-600">
                                    <li>His tragedy warns against **unthinking devotion** to any political leader or ideology.</li>
                                    <li>His faith allowed the farm's corruption; awareness without action is complicity.</li>
                                </ul>
                            </section>
                        </div>

                        <footer class="mt-6 pt-4 border-t border-gray-200 text-center text-xs text-gray-500">
                            ‚úèÔ∏è Adapted from sketch-note web summary.
                        </footer>
                    </div>
                `,
                // UPDATED: Benjamin to Benjamin & Clover
                'benjamin-clover': `
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">üêê Benjamin & Clover: The Silent and the Maternal Witnesses</h2>
                        <p class="text-gray-700">Paste the HTML content for your <strong>Benjamin & Clover</strong> report here. This section explores their roles as passive witnesses and the moral center of the farm. Remove external tags.</p>
                    </div>
                `,
                'humans': `
                    <title>Character & Context Synthesis ‚Äî The Humans (Animal Farm)</title>
                    <style>
                      :root{
                        --bg:#fcfbf7;
                        --ink:#222;
                        --ink-soft:#333;
                        --accent:#5b7cfa;
                        --accent-2:#ff8a5b;
                        --good:#1aa36f;
                        --warn:#c6781b;
                        --bad:#d34848;
                        --card:#fffef8;
                        --shadow: 0 2px 10px rgba(0,0,0,.07);
                      }
                      @media (prefers-color-scheme: dark){
                        :root{
                          --bg:#0f1115;
                          --ink:#eae9e6;
                          --ink-soft:#d5d3cd;
                          --accent:#8ea2ff;
                          --accent-2:#ffb38f;
                          --good:#41d399;
                          --warn:#ffb35b;
                          --bad:#ff6d6d;
                          --card:#141820;
                          --shadow: 0 2px 14px rgba(0,0,0,.35);
                        }
                      }
                      html,body{height:100%}
                      body{
                        margin:0;
                        font:16px/1.45 "Segoe UI", system-ui, -apple-system, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
                        background:var(--bg);
                        color:var(--ink);
                        -webkit-font-smoothing:antialiased;
                        -moz-osx-font-smoothing:grayscale;
                      }
                    
                      /* Hand-drawn vibe */
                      .scribble-border{
                        border:2px solid var(--ink);
                        border-radius:18px;
                        box-shadow:
                          0 0 0 2px var(--bg) inset,
                          3px 3px 0 0 rgba(0,0,0,.15);
                        position:relative;
                      }
                      .scribble-border:after{
                        content:"";
                        position:absolute; inset:-6px;
                        border:2px dashed rgba(0,0,0,.15);
                        border-radius:24px;
                        pointer-events:none;
                        filter: url(#wiggle);
                      }
                      .sketch{
                        background:var(--card);
                        filter: url(#paper);
                      }
                      .wavy-underline{
                        text-decoration:none;
                        background:
                          linear-gradient(transparent 65%, rgba(255,223,0,.6) 0) no-repeat;
                      }
                    
                      /* Layout */
                      .wrap{
                        display:grid;
                        grid-template-columns: 280px 1fr;
                        gap:24px;
                        max-width:1200px; margin:24px auto; padding:0 16px;
                      }
                      @media (max-width: 900px){
                        .wrap{grid-template-columns: 1fr}
                      }
                      header{
                        display:flex; align-items:center; justify-content:space-between;
                        gap:16px; margin:16px auto 0; max-width:1200px; padding:0 16px;
                      }
                      .title{
                        display:flex; gap:12px; align-items:center; flex-wrap:wrap;
                      }
                      .title h1{
                        margin:0; font-size: clamp(1.4rem, 2.5vw, 2rem);
                      }
                      .tag{
                        font-size:.85rem; padding:.25rem .55rem; border-radius:999px;
                        border:1.5px solid var(--ink);
                        background:var(--card);
                      }
                      .controls{
                        display:flex; gap:8px; align-items:center;
                      }
                      button, .chip{
                        cursor:pointer; border:2px solid var(--ink); background:var(--card); color:var(--ink);
                        padding:.55rem .8rem; border-radius:12px; font-weight:600;
                        box-shadow: var(--shadow);
                      }
                      button:hover{transform:translateY(-1px)}
                      .nav{
                        position:sticky; top:12px;
                        display:flex; flex-direction:column; gap:12px;
                      }
                      .step{
                        display:grid; grid-template-columns: 36px 1fr; gap:10px; align-items:center;
                        padding:10px; border-radius:14px; border:2px solid var(--ink);
                        background:var(--card);
                        transition:transform .06s ease;
                      }
                      .step.active{outline:3px dashed var(--accent); outline-offset:3px; transform:rotate(-.3deg)}
                      .step svg{width:28px; height:28px}
                      .step small{display:block; color:var(--ink-soft); margin-top:2px}
                    
                      main{display:grid; gap:20px}
                      section{
                        padding:18px; border-radius:18px;
                      }
                      .card{
                        padding:16px; border-radius:16px; background:var(--card); border:2px solid var(--ink);
                      }
                    
                      /* Flip cards for Characters / Mapping */
                      .grid{
                        display:grid; grid-template-columns: repeat(12, 1fr); gap:16px;
                      }
                      .g-6{grid-column: span 6}
                      .g-4{grid-column: span 4}
                      .g-8{grid-column: span 8}
                      .g-12{grid-column: span 12}
                      @media (max-width:900px){
                        .g-6,.g-4,.g-8{grid-column: span 12}
                      }
                      .flip{
                        perspective:1000px; position:relative; height:260px;
                      }
                      .flip .inner{
                        position:absolute; inset:0; transform-style:preserve-3d; transition:transform .6s ease;
                      }
                      .flip[aria-pressed="true"] .inner{transform:rotateY(180deg)}
                      .face{
                        position:absolute; inset:0; backface-visibility:hidden;
                        border-radius:16px; border:2px solid var(--ink); padding:14px; background:var(--card);
                        display:flex; flex-direction:column; justify-content:center; gap:10px;
                      }
                      .back{transform:rotateY(180deg)}
                      .face h3{margin:.2rem 0}
                      .face p{margin:0}
                    
                      /* Accordions */
                      details{
                        border:2px solid var(--ink); border-radius:14px; padding:10px 12px; background:var(--card);
                      }
                      details summary{
                        cursor:pointer; list-style:none; font-weight:700;
                      }
                      details summary::-webkit-details-marker{display:none}
                    
                      /* Hotspots diagram */
                      .diagram{
                        position:relative; min-height:300px; border-radius:18px; border:2px solid var(--ink);
                        background:var(--card);
                      }
                      .pin{
                        position:absolute; transform:translate(-50%,-50%); padding:.25rem .5rem;
                        border-radius:10px; border:2px solid var(--ink); background:var(--bg); font-size:.85rem;
                        white-space:nowrap; box-shadow: var(--shadow);
                      }
                      .pin[data-key]:hover{outline:3px dashed var(--accent-2); outline-offset:2px}
                      .legend{display:flex; gap:8px; flex-wrap:wrap}
                      .legend .chip{font-size:.85rem}
                    
                      /* Progress dots */
                      .progress{
                        display:flex; gap:8px; align-items:center; justify-content:center; margin:8px 0;
                      }
                      .dot{
                        width:12px; height:12px; border-radius:50%; border:2px solid var(--ink);
                        background:var(--card);
                      }
                      .dot.on{background:var(--accent)}
                    
                      /* CTA */
                      .cta{
                        display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
                      }
                      .kbd{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
                           padding:.1rem .35rem; border:1.5px solid var(--ink); border-radius:6px; background:var(--card); font-size:.9rem}
                      .muted{opacity:.7}
                    
                      /* Link buttons */
                      .pill{
                        display:inline-flex; align-items:center; gap:.45rem;
                        padding:.5rem .8rem; border:2px solid var(--ink); border-radius:999px; text-decoration:none; color:var(--ink);
                        background:var(--card);
                      }
                    
                      /* Tiny arrows and doodles */
                      .arrow{
                        display:inline-block; transform: translateY(-1px) rotate(-6deg);
                        font-weight:900; margin:0 6px;
                      }
                    
                      /* Accessibility focus */
                      :focus-visible{outline:3px dashed var(--accent); outline-offset:3px}
                    </style>
                    </head>
                    <body>
                    <!-- SVG filters for paper + wiggle -->
                    <svg width="0" height="0" aria-hidden="true" focusable="false" style="position:absolute">
                      <defs>
                        <filter id="paper">
                          <feTurbulence type="fractalNoise" baseFrequency="0.8" numOctaves="2" result="noise" seed="2"/>
                          <feColorMatrix type="saturate" values="0"/>
                          <feBlend in="SourceGraphic" in2="noise" mode="multiply" result="blend"/>
                          <feComponentTransfer>
                            <feFuncA type="linear" slope="0.97"/>
                          </feComponentTransfer>
                        </filter>
                        <filter id="wiggle">
                          <feTurbulence type="fractalNoise" baseFrequency="0.02" numOctaves="1" result="turb" seed="7"/>
                          <feDisplacementMap in="SourceGraphic" in2="turb" scale="1.5" xChannelSelector="R" yChannelSelector="G"/>
                        </filter>
                        <!-- Reusable icons -->
                        <symbol id="ico-hat" viewBox="0 0 24 24">
                          <path d="M3 14c4-2 14-2 18 0l-1 2c-4-2-12-2-16 0l-1-2Z" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M6 12c3-2 9-2 12 0" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M12 9c2 0 3-1 3-2s-1-2-3-2-3 1-3 2 1 2 3 2Z" fill="currentColor"/>
                        </symbol>
                        <symbol id="ico-bottle" viewBox="0 0 24 24">
                          <path d="M9 4h6v3l1 2v11a2 2 0 0 1-2 2H10a2 2 0 0 1-2-2V9l1-2V4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M12 4v-2" stroke="currentColor" stroke-width="2" />
                        </symbol>
                        <symbol id="ico-crown" viewBox="0 0 24 24">
                          <path d="M3 17l2-9 5 4 2-6 3 6 6-5 0 10H3Z" fill="none" stroke="currentColor" stroke-width="2"/>
                        </symbol>
                        <symbol id="ico-handshake" viewBox="0 0 24 24">
                          <path d="M4 13l4-4 4 4-2 2 2 2 2-2 2 2 4-4" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M8 9l-3-3M19 9l3-3" stroke="currentColor" stroke-width="2"/>
                        </symbol>
                        <symbol id="ico-book" viewBox="0 0 24 24">
                          <path d="M4 5a3 3 0 0 1 3-3h11v18H7a3 3 0 0 0-3 3V5Z" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M8 4h9" stroke="currentColor" stroke-width="2"/>
                        </symbol>
                        <symbol id="ico-globe" viewBox="0 0 24 24">
                          <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/>
                          <path d="M3 12h18M12 3a16 16 0 0 1 0 18M12 3a16 16 0 0 0 0 18" stroke="currentColor" stroke-width="2"/>
                        </symbol>
                        <symbol id="ico-arrow" viewBox="0 0 24 24">
                          <path d="M3 12h14" stroke="currentColor" stroke-width="2" fill="none"/>
                          <path d="M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" fill="none"/>
                        </symbol>
                      </defs>
                    </svg>
                    
                    <header>
                      <div class="title">
                        <svg width="42" height="42" viewBox="0 0 24 24" aria-hidden="true"><use href="#ico-book"/></svg>
                        <h1><span class="wavy-underline">Character & Context Synthesis</span> ‚Äî <em>The Humans</em></h1>
                        <span class="tag">Animal Farm</span>
                        <span class="tag">Sketchnote Edition</span>
                      </div>
                      <div class="controls">
                        <button id="darkToggle" aria-pressed="false" title="Toggle dark mode">üåó Theme</button>
                        <a class="pill" href="#how-to-read">How to read <span class="arrow">‚û∂</span></a>
                      </div>
                    </header>
                    
                    <div class="wrap">
                      <!-- Left nav -->
                      <nav class="nav">
                        <a class="step active" href="#step-1" data-step="1" aria-current="step">
                          <svg><use href="#ico-hat"/></svg>
                          <div><strong>1) Literary Data</strong><small>Traits & quotes</small></div>
                        </a>
                        <a class="step" href="#step-2" data-step="2">
                          <svg><use href="#ico-globe"/></svg>
                          <div><strong>2) Historical Context</strong><small>1917 & beyond</small></div>
                        </a>
                        <a class="step" href="#step-3" data-step="3">
                          <svg><use href="#ico-arrow"/></svg>
                          <div><strong>3) Allegory Map</strong><small>Who = Who</small></div>
                        </a>
                        <a class="step" href="#step-4" data-step="4">
                          <svg><use href="#ico-handshake"/></svg>
                          <div><strong>4) External Pressures</strong><small>Pacts & threats</small></div>
                        </a>
                        <a class="step" href="#step-5" data-step="5">
                          <svg><use href="#ico-crown"/></svg>
                          <div><strong>5) Synthesis</strong><small>So what?</small></div>
                        </a>
                    
                        <div class="card sketch scribble-border" id="how-to-read" style="margin-top:8px">
                          <strong>How to use this page</strong>
                          <ul>
                            <li><span class="kbd">Click</span> cards to flip for details.</li>
                            <li><span class="kbd">Open</span> accordions for quotes.</li>
                            <li><span class="kbd">Tap</span> diagram pins to highlight links.</li>
                            <li><span class="kbd">N</span>/<span class="kbd">P</span> for Next/Prev section.</li>
                          </ul>
                        </div>
                      </nav>
                    
                      <!-- Main content -->
                      <main>
                        <!-- Step 1 -->
                        <section id="step-1" class="sketch scribble-border">
                          <div class="progress" aria-label="progress">
                            <span class="dot on"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span>
                          </div>
                          <h2>1) Literary Data <span class="arrow">‚ûú</span> <em>The Humans</em></h2>
                          <div class="grid">
                            <div class="g-4">
                              <div class="flip" role="button" tabindex="0" aria-pressed="false" aria-label="Flip Farmer Jones card" data-flip>
                                <div class="inner">
                                  <div class="face">
                                    <h3><svg width="22" height="22"><use href="#ico-hat"/></svg> Farmer Jones</h3>
                                    <p><strong>Key Traits:</strong> Drunk, Incompetent, Neglectful, Exploitative.</p>
                                    <details>
                                      <summary>Key Action/Quote</summary>
                                      <p>‚ÄúToo drunk to remember to shut the pop-holes‚Äù (Ch. 1) ‚Äî triggers the animals‚Äô final, successful rebellion.</p>
                                    </details>
                                    <p class="muted">Click to flip <span aria-hidden="true">‚Ü∫</span></p>
                                  </div>
                                  <div class="face back">
                                    <p><strong>Symbolic function:</strong> Embodies the decayed <em>old regime</em> ‚Äî power without care, order without provision.</p>
                                    <p><strong>Mechanism of collapse:</strong> Not a master plan by animals, but the regime‚Äôs <em>own neglect</em> (no food).</p>
                                    <p class="muted">Click to flip back</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="g-4">
                              <div class="flip" role="button" tabindex="0" aria-pressed="false" aria-label="Flip Mr. Pilkington card" data-flip>
                                <div class="inner">
                                  <div class="face">
                                    <h3>Mr. Pilkington (Foxwood)</h3>
                                    <p><strong>Role:</strong> External landowner, skeptical neighbor.</p>
                                    <p><strong>Allegory:</strong> Western <em>Britain</em>‚Äîcapitalist power.</p>
                                    <p class="muted">Click to flip</p>
                                  </div>
                                  <div class="face back">
                                    <p>Represents <em>ongoing pressure</em> from the capitalist world: skepticism, opportunism, and later deals with the pigs.</p>
                                    <p class="muted">Click to flip back</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="g-4">
                              <div class="flip" role="button" tabindex="0" aria-pressed="false" aria-label="Flip Mr. Frederick card" data-flip>
                                <div class="inner">
                                  <div class="face">
                                    <h3>Mr. Frederick (Pinchfield)</h3>
                                    <p><strong>Role:</strong> Hard, aggressive neighbor.</p>
                                    <p><strong>Allegory:</strong> <em>Germany</em>‚Äîhostile, tactical.</p>
                                    <p class="muted">Click to flip</p>
                                  </div>
                                  <div class="face back">
                                    <p>Signals <em>deals & deceit</em> (e.g., forged banknotes), foreshadowing fragile pacts and betrayal.</p>
                                    <p class="muted">Click to flip back</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="g-12">
                              <details class="card">
                                <summary><strong>Narrator / Old Major Commentary</strong> (open)</summary>
                                <p><em>‚ÄúMan is the only creature that consumes without producing.‚Äù</em> ‚Äî establishes the ideological opponent the animals unite against.</p>
                              </details>
                            </div>
                          </div>
                        </section>
                    
                        <!-- Step 2 -->
                        <section id="step-2" class="sketch scribble-border">
                          <div class="progress"><span class="dot on"></span><span class="dot on"></span><span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
                          <h2>2) Historical Context <span class="arrow">‚ûú</span> 1917 & the End of the Tsarist Regime</h2>
                    
                          <div class="grid">
                            <div class="g-6">
                              <div class="card">
                                <h3><svg width="20" height="20"><use href="#ico-crown"/></svg> Historical Parallel</h3>
                                <ul>
                                  <li><strong>Farmer Jones</strong> <span class="arrow">‚Üí</span> <strong>Tsar Nicholas II</strong> & Tsarist aristocracy.</li>
                                  <li><strong>Pilkington</strong> <span class="arrow">‚Üí</span> Britain (capitalist West).</li>
                                  <li><strong>Frederick</strong> <span class="arrow">‚Üí</span> Germany (hostile power).</li>
                                </ul>
                                <p class="muted">Nickname: ‚Äú<em>Bloody Nicholas</em>‚Äù underscores repression & indifference.</p>
                              </div>
                            </div>
                            <div class="g-6">
                              <div class="card">
                                <h3>Key Concepts</h3>
                                <ul>
                                  <li><strong>1917 Revolution:</strong> Collapse of monarchy; abdication of Nicholas II.</li>
                                  <li><strong>External Hostility:</strong> Western suspicion of the Soviet experiment.</li>
                                  <li><strong>Shifting Deals:</strong> Tactical cooperation despite ideological enmity.</li>
                                </ul>
                              </div>
                            </div>
                            <div class="g-12">
                              <details class="card">
                                <summary><strong>Click to connect dots</strong> ‚Äî Why Jones‚Äôs negligence matters historically</summary>
                                <p>The rebellion is sparked by a <em>basic failure to feed</em> the animals. Allegorically, this mirrors the regime‚Äôs incapacity to meet essential needs‚Äîamplifying public unrest and making the fall inexorable.</p>
                              </details>
                            </div>
                          </div>
                        </section>
                    
                        <!-- Step 3 -->
                        <section id="step-3" class="sketch scribble-border">
                          <div class="progress"><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span><span class="dot"></span><span class="dot"></span></div>
                          <h2>3) Allegory Map <span class="arrow">‚ûú</span> Tap pins to highlight relationships</h2>
                    
                          <div class="diagram" id="map" aria-label="Interactive allegory map">
                            <!-- Animals side -->
                            <div class="pin" data-key="jones" style="left:14%;top:38%"><svg width="16" height="16" style="vertical-align:-2px"><use href="#ico-bottle"/></svg> Jones</div>
                            <div class="pin" data-key="pilk" style="left:18%;top:68%">Pilkington</div>
                            <div class="pin" data-key="fred" style="left:29%;top:16%">Frederick</div>
                    
                            <!-- History side -->
                            <div class="pin" data-key="nicholas" style="left:74%;top:40%"><svg width="16" height="16" style="vertical-align:-2px"><use href="#ico-crown"/></svg> Nicholas II</div>
                            <div class="pin" data-key="britain" style="left:82%;top:70%">Britain / Capitalist West</div>
                            <div class="pin" data-key="germany" style="left:66%;top:18%">Germany</div>
                    
                            <!-- SVG arrows -->
                            <svg width="100%" height="100%" style="position:absolute; inset:0" aria-hidden="true">
                              <!-- default grey lines -->
                              <defs>
                                <marker id="arrowhead" markerWidth="8" markerHeight="6" refX="7" refY="3" orient="auto">
                                  <polygon points="0 0, 8 3, 0 6" fill="currentColor"></polygon>
                                </marker>
                              </defs>
                              <g stroke="currentColor" stroke-width="2" opacity=".25">
                                <line id="line-jones-nicholas" x1="16%" y1="40%" x2="76%" y2="42%" marker-end="url(#arrowhead)"/>
                                <line id="line-pilk-brit" x1="20%" y1="70%" x2="84%" y2="72%" marker-end="url(#arrowhead)"/>
                                <line id="line-fred-ger" x1="31%" y1="18%" x2="68%" y2="20%" marker-end="url(#arrowhead)"/>
                              </g>
                            </svg>
                          </div>
                          <div class="legend" style="margin-top:8px">
                            <span class="chip">Tap a pin to highlight its mapping</span>
                            <span class="chip">Tap background to clear</span>
                          </div>
                        </section>
                    
                        <!-- Step 4 -->
                        <section id="step-4" class="sketch scribble-border">
                          <div class="progress"><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span><span class="dot"></span></div>
                          <h2>4) External Pressures <span class="arrow">‚ûú</span> Deals, Threats, & Treachery</h2>
                          <div class="grid">
                            <div class="g-8">
                              <div class="card">
                                <h3><svg width="18" height="18"><use href="#ico-handshake"/></svg> Fragile Cooperation</h3>
                                <p>The farm‚Äôs revolutionary ideals face <strong>constant outside pressure</strong>: suspicion, opportunism, and short-term pacts that erode purity.</p>
                                <ul>
                                  <li>Frederick‚Äôs <em>deceit</em> (e.g., forged notes) <span class="arrow">‚Üí</span> shows the cost of expedient alliances.</li>
                                  <li>Shifting relations with Pilkington <span class="arrow">‚Üí</span> mirrors the uneasy posture of the capitalist West.</li>
                                </ul>
                              </div>
                            </div>
                            <div class="g-4">
                              <div class="flip" role="button" tabindex="0" aria-pressed="false" aria-label="Flip Pact card" data-flip>
                                <div class="inner">
                                  <div class="face">
                                    <h3>Historical Echo</h3>
                                    <p><strong>Temporary cooperation</strong> between hostile powers for strategic gain.</p>
                                    <p class="muted">Click to flip</p>
                                  </div>
                                  <div class="face back">
                                    <p>Think of <em>infamous pacts</em> where rivals made time-bound deals despite core hostility‚Äîuseful, but corrosive to ideals.</p>
                                    <p class="muted">Click to flip back</p>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <div class="g-12">
                              <details class="card">
                                <summary><strong>Why it matters to the story</strong></summary>
                                <p>These pressures justify <em>tactical compromises</em> by the pigs, helping explain how the revolution‚Äôs egalitarian promise is surrendered for survival and power.</p>
                              </details>
                            </div>
                          </div>
                        </section>
                    
                        <!-- Step 5 -->
                        <section id="step-5" class="sketch scribble-border">
                          <div class="progress"><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span><span class="dot on"></span></div>
                          <h2>5) Synthesis <span class="arrow">‚ûú</span> What the Humans Do in the Novel‚Äôs Machine</h2>
                    
                          <div class="grid">
                            <div class="g-6">
                              <div class="card">
                                <h3>Literary Function</h3>
                                <p>The Humans personify the <strong>exploitative status quo</strong>. Jones‚Äôs personal flaws are symbols of a <em>systemic failure</em> that starves its subjects‚Äîso weak that it <strong>falls by neglect</strong>.</p>
                              </div>
                            </div>
                            <div class="g-6">
                              <div class="card">
                                <h3>Historical Mapping</h3>
                                <p>Jones <span class="arrow">‚Üí</span> <strong>Nicholas II</strong>. Chased off the farm <span class="arrow">‚Üí</span> <strong>1917 Revolution</strong>. Pilkington & Frederick <span class="arrow">‚Üí</span> <strong>Britain & Germany</strong> exerting pressure, cutting deals, and shaping outcomes.</p>
                              </div>
                            </div>
                            <div class="g-12">
                              <div class="card">
                                <h3>So What?</h3>
                                <p>By making <em>human failure</em> the spark for revolt and <em>human pressure</em> the acid that corrodes its ideals, Orwell shows how revolutions can be <strong>born from neglect</strong> and later <strong>bent by geopolitics</strong>.</p>
                              </div>
                            </div>
                          </div>
                    
                          <div class="cta">
                            <div>
                              <a class="pill" href="#step-1">Start Over ‚§∫</a>
                              <a class="pill" href="#step-3">Jump to Map ‚§≥</a>
                            </div>
                            <div class="muted">Tip: press <span class="kbd">N</span> / <span class="kbd">P</span> to move between sections.</div>
                          </div>
                        </section>
                      </main>
                    </div>
                    
                    <script>
                      // Theme toggle (graceful: just toggles a class on body)
                      const btn = document.getElementById('darkToggle');
                      const applyMode = () => {
                        const m = localStorage.getItem('sketchMode') || 'auto';
                        document.documentElement.dataset.theme = m;
                      };
                      btn.addEventListener('click', () => {
                        const cur = localStorage.getItem('sketchMode');
                        const next = cur === 'dark' ? 'light' : cur === 'light' ? 'dark' : 'dark';
                        localStorage.setItem('sketchMode', next);
                        // simulate theme by toggling a class ‚Äî browsers will respect prefers-color-scheme too
                        document.body.classList.toggle('manual-dark', next === 'dark');
                        document.body.classList.toggle('manual-light', next === 'light');
                      });
                    
                      // Flip cards
                      document.querySelectorAll('[data-flip]').forEach(el=>{
                        el.addEventListener('click', ()=> el.setAttribute('aria-pressed', el.getAttribute('aria-pressed')!=='true'));
                        el.addEventListener('keypress', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); el.click(); }});
                      });
                    
                      // Progress & nav highlighting on scroll
                      const steps = [...document.querySelectorAll('.step')];
                      const sections = [...document.querySelectorAll('main section')];
                      const dotsBySection = s => s.querySelectorAll('.dot');
                      const io = new IntersectionObserver(entries=>{
                        entries.forEach(ent=>{
                          if(ent.isIntersecting){
                            const id = ent.target.id;
                            steps.forEach(s=> s.classList.toggle('active', s.getAttribute('href')==='#'+id));
                            // turn on dots up to this section
                            const idx = sections.indexOf(ent.target);
                            sections.forEach((sec,i)=>{
                              const dots = dotsBySection(sec);
                              dots.forEach((d,j) => d.classList.toggle('on', j<=i));
                            });
                          }
                        });
                      }, {threshold:.5});
                      sections.forEach(s=> io.observe(s));
                    
                      // N / P keyboard navigation
                      addEventListener('keydown', (e)=>{
                        if (['INPUT','TEXTAREA','SELECT'].includes(document.activeElement.tagName)) return;
                        const idx = sections.findIndex(s=> {
                          const r = s.getBoundingClientRect();
                          return r.top<window.innerHeight/2 && r.bottom>window.innerHeight/2;
                        });
                        if(e.key.toLowerCase()==='n'){
                          const next = sections[Math.min(idx+1, sections.length-1)];
                          next?.scrollIntoView({behavior:'smooth', block:'start'});
                        } else if(e.key.toLowerCase()==='p'){
                          const prev = sections[Math.max(idx-1, 0)];
                          prev?.scrollIntoView({behavior:'smooth', block:'start'});
                        }
                      });
                    
                      // Allegory map interactions
                      const map = document.getElementById('map');
                      const lines = {
                        jones: document.getElementById('line-jones-nicholas'),
                        nicholas: document.getElementById('line-jones-nicholas'),
                        pilk: document.getElementById('line-pilk-brit'),
                        britain: document.getElementById('line-pilk-brit'),
                        fred: document.getElementById('line-fred-ger'),
                        germany: document.getElementById('line-fred-ger')
                      };
                      let clearTimer;
                      const clearAll = () => {
                        map.querySelectorAll('.pin').forEach(p=>p.style.outline='none');
                        map.querySelectorAll('line').forEach(l=>{ l.style.opacity=.25; l.style.stroke = 'currentColor'; });
                      };
                      const highlight = (key) => {
                        clearTimeout(clearTimer);
                        clearAll();
                        const pin = map.querySelector(`.pin[data-key="${key}"]`);
                        if(pin){
                          pin.style.outline='4px dashed var(--accent)';
                          const line = lines[key];
                          if(line){
                            line.style.opacity=1;
                            line.style.stroke='var(--accent)';
                          }
                        }
                        clearTimer = setTimeout(()=>{}, 0);
                      };
                      map.addEventListener('click', (e)=>{
                        const pin = e.target.closest('.pin');
                        if(!pin){ clearAll(); return; }
                        const key = pin.dataset.key;
                        highlight(key);
                      });
                    
                      // Anchor clicks update nav
                      steps.forEach(s=>{
                        s.addEventListener('click', ()=>{
                          steps.forEach(x=>x.classList.remove('active'));
                          s.classList.add('active');
                        });
                      });
                    
                      // Initial theme apply
                      applyMode();
                    </script>
                    </body>

                `,
                'mollie-moses': `
                    <div class="bg-paper p-8 rounded-xl shadow-xl border-t-4 border-accent-red">
                        <h2 class="text-3xl font-extrabold text-primary-red mb-4">üéÄ Mollie & Moses: Distraction and Escape</h2>
                        <p class="text-gray-700">Paste the HTML content for your <strong>Mollie & Moses</strong> report here. Remove external tags.</p>
                    </div>
                `
            };
            
            // --- 2. Routing Logic ---

            // Function to render the specific page content
            const renderPage = (pageId) => {
                const content = PAGES[pageId] || PAGES['home'];
                contentView.innerHTML = content;
                
                // Update active link styling
                document.querySelectorAll('.nav-item a').forEach(link => {
                    if (link.dataset.page === pageId) {
                        // Active link style using accent-red background
                        link.classList.remove('text-red-100', 'hover:bg-primary-red');
                        link.classList.add('bg-accent-red', 'text-white', 'shadow-md');
                    } else {
                        // Inactive link style
                        link.classList.add('text-red-100', 'hover:bg-primary-red');
                        link.classList.remove('bg-accent-red', 'text-white', 'shadow-md');
                    }
                });

                // Close sidebar on mobile after navigating
                if (window.innerWidth < 768) {
                    sidebar.classList.add('-translate-x-full');
                }

                // Update the URL hash without reloading the page
                history.pushState(null, '', '#' + pageId);
                
                // Scroll to the top of the content area
                window.scrollTo(0, 0);
            };

            // Event listener for navigation clicks
            document.querySelectorAll('.nav-item a').forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    const pageId = link.dataset.page;
                    renderPage(pageId);
                });
            });

            // Handle initial load and browser back/forward buttons
            const loadInitialPage = () => {
                const hash = window.location.hash.substring(1) || 'home';
                renderPage(hash);
            };

            window.addEventListener('hashchange', loadInitialPage);
            loadInitialPage(); // Load content on first page visit

            // --- 3. Mobile Menu Toggle ---
            menuBtn.addEventListener('click', () => {
                sidebar.classList.toggle('-translate-x-full');
            });

        });
    </script>
</body>
</html>
